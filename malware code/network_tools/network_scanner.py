#!/usr/bin/env python
import  scapy.all as s
import subprocess
import time
def scan(a):
    d={}
    arp_request=s.ARP(pdst=a) #to create a request
    arp_broadcast=s.Ether(dst="ff:ff:ff:ff:ff:ff") #to set the returm place
    #dst can be any mac
    arp_complete=arp_broadcast/arp_request #to combine request and broadcast
    answered=s.srp(arp_complete,timeout=1)[0] #to broadcasst or send the packets,answered means ip valid
    time.sleep(2)
    subprocess.run("clear")
    print("|        I.P    |      MAC Address   |")
    print("-"*45)
    for i in answered:
        d[i[1].psrc]=i[1].hwsrc
    for i,j in d.items():
        print(i,"|",j,"|")
scan("192.168.29.1/24")
